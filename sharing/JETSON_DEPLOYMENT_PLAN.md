# Jetson実機デプロイ計画案 (ROS 2ベース)

本ドキュメントは、シミュレーションで学習した強化学習（RL）モデルを F1TENTH 実機（Jetson）へ移行するための計画案である。チームメンバーへの情報共有およびレビューを目的とする。

## 1. 目的
シミュレーション（f1tenth_gym）で学習された PPO モデルを、ROS 2 環境を通じて実機の LiDAR およびモーター制御へと統合し、自律走行を実現する。

## 2. 採用するアーキテクチャ: ROS 2 ブリッジ方式
ROS 2 をミドルウェアとして使用し、AIモデルを一つの「ブリッジノード」として動作させる。

- **入力 (/scan)**: 実機 LiDAR からの点群データ。
- **変換**: 1080点のデータを、学習時と同じ108点にダウンサンプリング。←これはやめる。
- **推論**: `stable-baselines3` を使用し、観測データから [ステアリング, 速度] を算出。
- **出力 (/drive)**: `AckermannDriveStamped` メッセージとして実機の VESC（モーター制御）へ送信。

## 3. 必要な環境構築 (Jetson)
Jetson 上で以下の環境を Docker もしくはネイティブで構築する必要がある。

- **OS**: Ubuntu 20.04/22.04 (JetPack 5.x/6.x)
- **Middleware**: ROS 2 Humble
- **Python Libraries**: 
  - `stable-baselines3`
  - `gym==0.23.1`
  - `torch` (Jetson 対応版)
- **Drivers**: F1TENTH 公式 ROS 2 ドライバスタック

## 4. 実装のステップ（案）
1. **環境診断**: Jetson 上で LiDAR と VESC が ROS 2 トピックとして通信できているかを確認。
2. **ブリッジノード設計**: センサーデータの型変換と推論結果の送信を行う Python ノードのロジック確定。
3. **パラメータ調整**: シミュレーションと実機の物理的な差異（最高速度、最小旋回半径等）を `config.py` に反映。
4. **安全検証**: 
   - 車体を浮かせた状態での動作確認（空転テスト）。
   - 低速設定での低速周回テスト。

## 5. 懸案事項・検討が必要な点
- **トピック名の共通化**: 実機環境の `/scan` や `/drive` の名称が標準と異なる場合の対応。
- **演算負荷**: Jetson 上でのリアルタイム推論が制御周期（20Hz〜）に間に合うかの検証。
- **ネットワーク**: リモートからの緊急停止（Kill-switch）の確実な運用。
